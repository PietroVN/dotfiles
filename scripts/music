#!/usr/bin/bash

echo "Video/Music to play"
read NAME
echo ""

sleep 3

# play song
mpv --no-terminal --no-video --input-ipc-server=/tmp/mpvsocket $(youtube-dl --get-url ytsearch:"${NAME}") &


# Main Loop
while true; do
		echo "Receiving Commands:"
		read COMMAND

		# Quit
		if [[ ${COMMAND} == "quit" ]]; then
				echo '{ "command": ["quit"] }' | socat - /tmp/mpvsocket $1 > /dev/null
				break
		fi

		# Seek
		if [[ ${COMMAND} == "seek" ]]; then
				echo "Seek:"
				read SEEK
				sed "s/SEEK/${SEEK}/g" <<< '{ "command": ["set_property", "playback-time", "SEEK"] }'  | socat - /tmp/mpvsocket > /dev/null
		fi

done

